<!DOCTYPE html>
<html>
<head>
    <title>爱的记忆挑战</title>
    <style>
        /* 新增最终页面样式 */
        #finalPage {
            display: none;
            text-align: center;
        }
        .photo-frame {
            width: 400px;
            height: 500px;
            margin: 30px auto;
            border: 3px solid #ff69b4;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .photo-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
    </style>
</head>
<body>
    <!-- 步骤指示器修改为三步 -->
    <div class="step-indicator">第1步/共3步</div>

    <!-- 新增最终页面结构 -->
    <div class="main-container" id="finalPage">
        <h2 style="color: #ff69b4; margin-bottom: 30px;">🎉 记忆重现时刻 🎉</h2>
        <div class="photo-frame">
            <img src="https://example.com/your-image.jpg" alt="我们的记忆"> <!-- 替换为你的图片URL -->
        </div>
        <button onclick="downloadSecret()" style="margin-top: 40px;">下载爱的记忆文件</button>
    </div>

    <!-- 修改原有脚本部分 -->
    <script>
        // 修改验证函数
        function validateAnswers() {
            const errorMsg = document.getElementById('errorMsg');
            errorMsg.style.display = 'none';

            // 获取用户输入
            const userYear = parseInt(yearSelect.value);
            const userMonth = parseInt(monthSelect.value);
            const userDay = parseInt(daySelect.value);
            const userDays = parseInt(document.getElementById('daysInput').value);

            // 计算正确答案
            const correctDate = new Date(2024, 1, 3);
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            const timeDiff = today - correctDate;
            const correctDays = Math.floor(timeDiff / (1000 * 3600 * 24));

            // 验证逻辑
            const isDateCorrect = userYear === 2024 && userMonth === 2 && userDay === 3;
            const isDaysCorrect = userDays === correctDays;

            if(isDateCorrect && isDaysCorrect) {
                showFinalPage();
            } else {
                showError();
            }
        }

        // 新增页面跳转函数
        function showFinalPage() {
            // 先显示成功页面
            document.getElementById('questionPage').style.display = 'none';
            document.getElementById('successPage').style.display = 'block';
            document.querySelector('.step-indicator').textContent = '第2步/共3步';

            // 3秒后自动跳转最终页面
            setTimeout(() => {
                document.getElementById('successPage').style.display = 'none';
                document.getElementById('finalPage').style.display = 'block';
                document.querySelector('.step-indicator').textContent = '第3步/共3步';
            }, 3000);
        }

        // 保持音乐持续播放
        let music = document.getElementById('backgroundMusic');
        window.addEventListener('beforeunload', function() {
            // 保存音乐播放状态
            localStorage.setItem('musicTime', music.currentTime);
            localStorage.setItem('musicPlaying', !music.paused);
        });

        window.addEventListener('load', function() {
            // 恢复音乐播放状态
            const savedTime = localStorage.getItem('musicTime');
            const wasPlaying = localStorage.getItem('musicPlaying') === 'true';
            
            if (savedTime) {
                music.currentTime = savedTime;
                if (wasPlaying) {
                    music.play();
                    document.getElementById('playButton').style.display = 'none';
                }
            }
            
            initDatePicker();
        });
    </script>
</body>
</html>

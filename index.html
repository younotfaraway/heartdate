<!DOCTYPE html>
<html>
<head>
    <title>çˆ±çš„è®°å¿†æŒ‘æˆ˜</title>
    <style>
        /* æ–°å¢æœ€ç»ˆé¡µé¢æ ·å¼ */
        #finalPage {
            display: none;
            text-align: center;
        }
        .photo-frame {
            width: 400px;
            height: 500px;
            margin: 30px auto;
            border: 3px solid #ff69b4;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .photo-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
    </style>
</head>
<body>
    <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ä¿®æ”¹ä¸ºä¸‰æ­¥ -->
    <div class="step-indicator">ç¬¬1æ­¥/å…±3æ­¥</div>

    <!-- æ–°å¢æœ€ç»ˆé¡µé¢ç»“æ„ -->
    <div class="main-container" id="finalPage">
        <h2 style="color: #ff69b4; margin-bottom: 30px;">ğŸ‰ è®°å¿†é‡ç°æ—¶åˆ» ğŸ‰</h2>
        <div class="photo-frame">
            <img src="https://example.com/your-image.jpg" alt="æˆ‘ä»¬çš„è®°å¿†"> <!-- æ›¿æ¢ä¸ºä½ çš„å›¾ç‰‡URL -->
        </div>
        <button onclick="downloadSecret()" style="margin-top: 40px;">ä¸‹è½½çˆ±çš„è®°å¿†æ–‡ä»¶</button>
    </div>

    <!-- ä¿®æ”¹åŸæœ‰è„šæœ¬éƒ¨åˆ† -->
    <script>
        // ä¿®æ”¹éªŒè¯å‡½æ•°
        function validateAnswers() {
            const errorMsg = document.getElementById('errorMsg');
            errorMsg.style.display = 'none';

            // è·å–ç”¨æˆ·è¾“å…¥
            const userYear = parseInt(yearSelect.value);
            const userMonth = parseInt(monthSelect.value);
            const userDay = parseInt(daySelect.value);
            const userDays = parseInt(document.getElementById('daysInput').value);

            // è®¡ç®—æ­£ç¡®ç­”æ¡ˆ
            const correctDate = new Date(2024, 1, 3);
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            const timeDiff = today - correctDate;
            const correctDays = Math.floor(timeDiff / (1000 * 3600 * 24));

            // éªŒè¯é€»è¾‘
            const isDateCorrect = userYear === 2024 && userMonth === 2 && userDay === 3;
            const isDaysCorrect = userDays === correctDays;

            if(isDateCorrect && isDaysCorrect) {
                showFinalPage();
            } else {
                showError();
            }
        }

        // æ–°å¢é¡µé¢è·³è½¬å‡½æ•°
        function showFinalPage() {
            // å…ˆæ˜¾ç¤ºæˆåŠŸé¡µé¢
            document.getElementById('questionPage').style.display = 'none';
            document.getElementById('successPage').style.display = 'block';
            document.querySelector('.step-indicator').textContent = 'ç¬¬2æ­¥/å…±3æ­¥';

            // 3ç§’åè‡ªåŠ¨è·³è½¬æœ€ç»ˆé¡µé¢
            setTimeout(() => {
                document.getElementById('successPage').style.display = 'none';
                document.getElementById('finalPage').style.display = 'block';
                document.querySelector('.step-indicator').textContent = 'ç¬¬3æ­¥/å…±3æ­¥';
            }, 3000);
        }

        // ä¿æŒéŸ³ä¹æŒç»­æ’­æ”¾
        let music = document.getElementById('backgroundMusic');
        window.addEventListener('beforeunload', function() {
            // ä¿å­˜éŸ³ä¹æ’­æ”¾çŠ¶æ€
            localStorage.setItem('musicTime', music.currentTime);
            localStorage.setItem('musicPlaying', !music.paused);
        });

        window.addEventListener('load', function() {
            // æ¢å¤éŸ³ä¹æ’­æ”¾çŠ¶æ€
            const savedTime = localStorage.getItem('musicTime');
            const wasPlaying = localStorage.getItem('musicPlaying') === 'true';
            
            if (savedTime) {
                music.currentTime = savedTime;
                if (wasPlaying) {
                    music.play();
                    document.getElementById('playButton').style.display = 'none';
                }
            }
            
            initDatePicker();
        });
    </script>
</body>
</html>
